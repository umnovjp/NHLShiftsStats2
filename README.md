# NHLShiftsStats3
## Background
Original repo is located at https://github.com/umnovjp/NHLShiftStats1. It was working in 98% of games. But with NHL changing its APIs without any announcement I realized that it was better to start new repo from scratch instead of fixing original one. One of the reasons is that trying to fix issues with original repo created too many new hurdles. Like fixing one led to a new one. And as script progressed, I knew I am on the right path after 2 years of JavaScript experience. What I could not accomplish with 1200 lines of code last year, I did with just 400 lines. Compare script.js files! Another NHL stats repo https://github.com/umnovjp/NHLShiftStats1 will be easier to fix.
## Usage
First thing is to select a date. And remember to select date when games actually were played. ![calendar](image.png) 
Then you will be prompted to select a game. Press one button to select a game. ![select a game](image-1.png) Separate tables will be displayed for home and away team defensemen. ![Alt text](image-2.png) You can easy determine defensive pairs from this table. It is not that easy for forward lines. Because lines of three forwards are not that easy to display in a 2D table. This is how it is done currently ![Alt text](image-3.png). Also, special teams are frequently played with 2 or 4 forwards depending on if it is penalty kill or power play. This script limits 5x5 play as play with 2D and 3F only. This is done to exclude PP with 4F and 1 D. Still it includes PP with 3F and 2D. 

Definition of shift is 10 seconds pair of defensmen or trio of forwards played continuously at the same time. 
## Known Failures
Some game data are not displayed correctly because of obvious errors in NHL API data. Example is STL at FLA game on 12/21/2023 where data for many shifts are duplicated. Similar example is TOR at CBJ game on 12/23/2023 where many shifts are duplicated while some non existing overlapping shifts are added. Game CBJ at NJD on 12/28/2023 generated unreliable results for DMen because there were 3 of them on ice frequently. Most likely one D(#2?) was dressed as an F, but game report still counts him as D. Currently game 3 on 01/04 displays 4 lines because H team had 7 Ds but #71 belongs to 2 lines. Game 2 on 01/07 away has 5 lines. Game 5 on 01/09 A has 3 lines only. More exceptions will be added later. Game 9 on 1/13 A has 3 ;ines with 7D. Game 1 on 1/14 only 3 h lines are displayed because 3 played on 2 lines. game 0 on 1/15 had 5 lines calculated correctly. game 8 on 1/15 only 3 lines displayed. game 6 on 1/16 determines lines correctly. but toi is absolutely wrong. game 3 on 1/18 #11 played on two lines for home team. game 10 on 1/18 H has 5 lines but #21 and #61 played om 2 lines. 0611 1310 249 3410 578 are lines. 0611 578 are unique lines. Game 3 on 1/19 has 5 limes correct. Game 3 on 1/20 A ahas 5 lines incorrect. Unique lines are 137 and 2410. on 1/21 game 0 H lines are incorrect because #11 played on 2 lines. on 1/22  game 3 H team played #9 played on 2 lines. Game 2 on 1/25 H has 5 lines incorrectly. 017 268 are unique. Game 4 on 01/27 has 5 lines incorrectly only 5910 line is unique. game 0 on 01/29 12 F but only 11 displayed. And for H team, all lines changed in 2nd. 

om 1/30 checked 01/11 to 1/30. 